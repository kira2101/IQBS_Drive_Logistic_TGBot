# Logistics Time Tracking Bot

Телеграм-бот для учета времени и расходов в логистике. Позволяет фиксировать поездки, работу на объектах, закупки и автоматически распределять затраты по проектам.

## Возможности

- **Учет рабочего времени**: Начало и конец рабочего дня
- **Отслеживание поездок**: Время в пути и километраж с привязкой к проектам
- **Закупки**: Распределение времени закупок между несколькими проектами
- **Работа на объектах**: Учет времени работы на конкретных объектах
- **Автоматические отчеты**: Детализированный отчет по окончании дня

## Установка

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd bot_drive_logistic
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Настройте окружение:
```bash
cp .env .env
# Отредактируйте .env файл, добавив токен бота
```

4. Создайте начальные проекты:
```bash
python setup_projects.py
```

5. Запустите бота:
```bash
python bot.py
```

## Получение токена бота

1. Найдите @BotFather в Telegram
2. Отправьте команду `/newbot`
3. Следуйте инструкциям для создания бота
4. Скопируйте токен в файл `.env`

## Команды бота

- `/start_day` - Начать рабочий день
- `/drive_to` - Начать поездку (выбор из кнопок)
- `/arrive` - Прибыть в пункт назначения
- `/shop_for` - Начать закупку для проектов
- `/work_on` - Начать работу на объекте
- `/end_activity` - Закончить текущую деятельность
- `/end_day` - Закончить рабочий день и показать отчет
- `/help` - Показать справку

## Принцип работы

### Распределение затрат

1. **Поездки**: Время и километраж поездки полностью относятся к пункту назначения
2. **Закупки**: Время в магазине делится поровну между всеми выбранными проектами
3. **Работа**: Время работы полностью относится к выбранному проекту

### Пример использования

```
7:00 - /start_day
7:00 - /drive_to → Магазин
8:00 - /arrive → 15 км
8:00 - /shop_for → Объект 1, Объект 2, Склад
9:00 - /end_activity (1 час закупок → по 20 мин на каждый проект)
9:00 - /drive_to → Объект 1
9:30 - /arrive → 15 км
9:30 - /drive_to → Объект 2
11:30 - /arrive → 25 км
11:30 - /drive_to → Объект 3
12:00 - /arrive → 10 км
12:00 - /work_on → Объект 3
14:00 - /end_activity (2 часа работы → Объект 3)
14:00 - /drive_to → Склад
15:00 - /arrive → 35 км
15:00 - /end_day
```

## Структура проекта

- `bot.py` - Основной файл с обработчиками команд
- `models.py` - Модели базы данных
- `database.py` - Настройка подключения к БД
- `state_manager.py` - Управление состояниями пользователей
- `report_generator.py` - Генерация отчетов
- `setup_projects.py` - Создание начальных проектов

## База данных

По умолчанию используется SQLite. Для PostgreSQL измените `DATABASE_URL` в `.env` файле:
```
DATABASE_URL=postgresql://username:password@localhost/database_name
```